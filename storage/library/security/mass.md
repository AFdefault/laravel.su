---
title: "Массовое присвоение"
description: "Предотвратите несанкционированные изменения данных."
---

Массовое присвоение - это уязвимость, когда ORM позволяет изменять данные, которые пользователь обычно не должен иметь возможность изменять.

Рассмотрим следующий код:

```php
Route::any('/profile', function (Request $request) {
    $user = $request->user();
    
    $user->forceFill($request->all())->save();

    return response()->json(['user' => $user]);
})->middleware('auth');
```

Этот маршрут позволяет пользователям изменять информацию в своем профиле.

Однако, предположим, что в таблице пользователей есть столбец `is_admin`. Вы, вероятно, не хотите, чтобы пользователь мог изменять это значение. Но код выше позволяет им изменять любые значения в их профиле, включая `is_admin`. Это уязвимость массового присвоения.

В Laravel по умолчанию встроены функции для защиты от этой уязвимости. Чтобы оставаться в безопасности:

- Ограничьте параметры, которые вы хотите обновить, используя `$request->only` или `$request->validated`, а не `$request->all`.
- Не разрешайте все поля модели, не устанавливая `$guarded` как пустой массив. Это отключит защиту от массового присвоения Laravel.
- Избегайте использования методов, таких как `forceFill` или `forceCreate`, которые могут обойти защиту. Однако, если вы передаете проверенный массив значений, вы можете использовать их.
