## Cookie и управление сессиями

По умолчанию Laravel настроен безопасно. Однако, если вы изменяете конфигурации cookie или сессий, убедитесь в следующем:

- Включите промежуточное ПО шифрования cookie, если вы используете хранилище сессий `cookie` или храните какие-либо данные, которые не должны быть доступны или изменены клиентами. В общем случае это должно быть включено, если ваше приложение не имеет очень специфического случая использования, требующего отключения этого. Чтобы включить это промежуточное ПО, просто добавьте промежуточное ПО `EncryptCookies` в группу промежуточного ПО `web` в классе `App\Http\Kernel`:

```php
/**
* The application's route middleware groups.
*
* @var array
*/
protected $middlewareGroups = [
    'web' => [
        \App\Http\Middleware\EncryptCookies::class,
        // ...
    ],
    // ...
];
```

- Включите атрибут `HttpOnly` для ваших сессионных cookie через файл `config/session.php`, чтобы ваши сессионные cookie были недоступны из Javascript:

```php
'http_only' => true,
```

- Если вы не используете регистрацию поддомена в вашем приложении Laravel, рекомендуется установить атрибут `domain` для cookie в значение null, чтобы только исходный домен (за исключением поддоменов) мог устанавливать cookie. Это можно настроить в файле `config/session.php`:

```php
'domain' => null,
```

- Установите атрибут `SameSite` вашего cookie в `lax` или `strict` в файле `config/session.php`, чтобы ограничить ваши cookie контекстом первой или того же сайта:

```php
'same_site' => 'lax',
```

- Если ваше приложение использует только HTTPS, рекомендуется установить параметр `secure` в вашем файле `config/session.php` в значение `true`, чтобы защититься от атак посредника. Если ваше приложение использует комбинацию HTTP и HTTPS, тогда рекомендуется установить это значение в `null`, чтобы атрибут secure автоматически устанавливался при обработке HTTPS-запросов:

```php
'secure' => null,
```

- Убедитесь, что у вас установлено низкое значение таймаута сессии. OWASP рекомендует таймаут сессии от 2 до 5 минут для приложений с высоким риском и от 15 до 30 минут для приложений с низким. Это можно настроить в файле `config/session.php`:

```php
'lifetime' => 15,
```

Вы также можете обратиться к [Руководству по Безопасности Cookie](https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20171130_Cookie_Security_Myths_Misconceptions_David_Johansson.pdf), чтобы узнать больше о безопасности cookie и упомянутых выше атрибутах cookie.
